name: Desligar Servidor Agora
on:
  workflow_dispatch:

permissions:
  codespaces: write

jobs:
  stop-codespace:
    runs-on: ubuntu-latest
    steps:
      - name: For√ßar Desligamento
        run: |
          # Busca o nome automaticamente e desliga
          NAME=$(gh codespace list --repo ${{ github.repository }} --json name --jq '.[0].name')
          
          if [ -z "$NAME" ] || [ "$NAME" == "null" ]; then
            echo "Nenhum codespace ativo encontrado."
          else
            echo "Desligando: $NAME"
            gh codespace stop -c "$NAME"
          fi
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
